\subsection{include/h8sdk/sci.h ファイル}
\label{sci_8h}\index{include/h8sdk/sci.\+h@{include/h8sdk/sci.\+h}}


シリアルポートドライバ  


{\ttfamily \#include \char`\"{}stddef.\+h\char`\"{}}\\*
sci.\+h の依存先関係図\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=145pt]{de/dc7/sci_8h__incl}
\end{center}
\end{figure}
\subsubsection*{マクロ定義}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{sci_8h_a3215a6d64ad06026d58b5f2a823def50_a3215a6d64ad06026d58b5f2a823def50}{S\+C\+I\+\_\+\+M\+A\+X\+\_\+\+T\+X\+B\+U\+F}~128
\begin{DoxyCompactList}\small\item\em 送信バッファサイズ \end{DoxyCompactList}\item 
\#define \hyperlink{sci_8h_a6f5d317e038f60b708d778579f143874_a6f5d317e038f60b708d778579f143874}{S\+C\+I\+\_\+\+M\+A\+X\+\_\+\+R\+X\+B\+U\+F}~128
\begin{DoxyCompactList}\small\item\em 受信バッファサイズ \end{DoxyCompactList}\item 
\#define \hyperlink{sci_8h_a3ebdf406c8df76754b38447eb28a4281_a3ebdf406c8df76754b38447eb28a4281}{S\+C\+I\+\_\+\+E\+R\+R\+\_\+\+P\+A\+R\+I\+T\+Y}~(1\+U $<$$<$ 0)
\begin{DoxyCompactList}\small\item\em パリティエラー識別子 \end{DoxyCompactList}\item 
\#define \hyperlink{sci_8h_a77d50c920e6676c04c79fde16f1fc975_a77d50c920e6676c04c79fde16f1fc975}{S\+C\+I\+\_\+\+E\+R\+R\+\_\+\+F\+R\+A\+M\+I\+N\+G}~(1\+U $<$$<$ 1)
\begin{DoxyCompactList}\small\item\em フレーミングエラー識別子 \end{DoxyCompactList}\item 
\#define \hyperlink{sci_8h_a6797a01bd01e4173548063aa903a953f_a6797a01bd01e4173548063aa903a953f}{S\+C\+I\+\_\+\+E\+R\+R\+\_\+\+O\+V\+E\+R\+R\+U\+N}~(1\+U $<$$<$ 2)
\begin{DoxyCompactList}\small\item\em オーバーランエラー識別子 \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{関数}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{sci_8h_a9f5d4690ca7dcd66e71193d76c18391b_a9f5d4690ca7dcd66e71193d76c18391b}{S\+C\+I\+\_\+init} ()
\begin{DoxyCompactList}\small\item\em S\+C\+I初期化 \end{DoxyCompactList}\item 
void \hyperlink{sci_8h_aed4704fa2e59ccf969ed22ba91e76b95_aed4704fa2e59ccf969ed22ba91e76b95}{S\+C\+I\+\_\+communicate} ()
\begin{DoxyCompactList}\small\item\em 送受信実行 \end{DoxyCompactList}\item 
\hyperlink{stddef_8h_aefd1068e35d26c0e7d7079ddf2579174_aefd1068e35d26c0e7d7079ddf2579174}{\+\_\+\+S\+I\+N\+T} \hyperlink{sci_8h_af190c2cffd8521e60eeef84c3a81208e_af190c2cffd8521e60eeef84c3a81208e}{S\+C\+I\+\_\+puts} (const \hyperlink{stddef_8h_aab65237ca9fbf4192a39cf12dd165942_aab65237ca9fbf4192a39cf12dd165942}{\+\_\+\+S\+B\+Y\+T\+E} $\ast$str)
\begin{DoxyCompactList}\small\item\em 文字列送信 \end{DoxyCompactList}\item 
\hyperlink{stddef_8h_aefd1068e35d26c0e7d7079ddf2579174_aefd1068e35d26c0e7d7079ddf2579174}{\+\_\+\+S\+I\+N\+T} \hyperlink{sci_8h_afa2f96406c0057e6939906291282afa3_afa2f96406c0057e6939906291282afa3}{S\+C\+I\+\_\+write} (const \hyperlink{stddef_8h_aac464b47452ce9406f88ef194e2becc1_aac464b47452ce9406f88ef194e2becc1}{\+\_\+\+U\+B\+Y\+T\+E} $\ast$data, \hyperlink{stddef_8h_aac464b47452ce9406f88ef194e2becc1_aac464b47452ce9406f88ef194e2becc1}{\+\_\+\+U\+B\+Y\+T\+E} size, \hyperlink{stddef_8h_afbf708854fe02af8475a9ba02f3196cb_afbf708854fe02af8475a9ba02f3196cb}{\+\_\+\+B\+O\+O\+L} sync, \hyperlink{stddef_8h_aefd1068e35d26c0e7d7079ddf2579174_aefd1068e35d26c0e7d7079ddf2579174}{\+\_\+\+S\+I\+N\+T} tmo\+\_\+ms)
\begin{DoxyCompactList}\small\item\em バイトストリーム送信 \end{DoxyCompactList}\item 
\hyperlink{stddef_8h_aefd1068e35d26c0e7d7079ddf2579174_aefd1068e35d26c0e7d7079ddf2579174}{\+\_\+\+S\+I\+N\+T} \hyperlink{sci_8h_a66e375aea15eee910b1fbf6002f09154_a66e375aea15eee910b1fbf6002f09154}{S\+C\+I\+\_\+read} (\hyperlink{stddef_8h_aac464b47452ce9406f88ef194e2becc1_aac464b47452ce9406f88ef194e2becc1}{\+\_\+\+U\+B\+Y\+T\+E} $\ast$buf, \hyperlink{stddef_8h_aac464b47452ce9406f88ef194e2becc1_aac464b47452ce9406f88ef194e2becc1}{\+\_\+\+U\+B\+Y\+T\+E} size, \hyperlink{stddef_8h_afbf708854fe02af8475a9ba02f3196cb_afbf708854fe02af8475a9ba02f3196cb}{\+\_\+\+B\+O\+O\+L} sync, \hyperlink{stddef_8h_aefd1068e35d26c0e7d7079ddf2579174_aefd1068e35d26c0e7d7079ddf2579174}{\+\_\+\+S\+I\+N\+T} tmo\+\_\+ms)
\begin{DoxyCompactList}\small\item\em バイトストリーム受信 \end{DoxyCompactList}\item 
\hyperlink{stddef_8h_aac464b47452ce9406f88ef194e2becc1_aac464b47452ce9406f88ef194e2becc1}{\+\_\+\+U\+B\+Y\+T\+E} \hyperlink{sci_8h_a31c5c3fad1871cd4940561cd57610d00_a31c5c3fad1871cd4940561cd57610d00}{S\+C\+I\+\_\+get\+Last\+Error} ()
\begin{DoxyCompactList}\small\item\em エラー値取得 \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsubsection{詳解}
シリアルポートドライバ 

このモジュールはシリアルポートデバイス\+S\+C\+I3へのインタフェースを提供する

\begin{DoxySeeAlso}{参照}
H83694グループ\+\_\+ハードウェアマニュアル.\+pdf 14章
\end{DoxySeeAlso}
 

\subsubsection{マクロ定義詳解}
\index{sci.\+h@{sci.\+h}!S\+C\+I\+\_\+\+M\+A\+X\+\_\+\+T\+X\+B\+U\+F@{S\+C\+I\+\_\+\+M\+A\+X\+\_\+\+T\+X\+B\+U\+F}}
\index{S\+C\+I\+\_\+\+M\+A\+X\+\_\+\+T\+X\+B\+U\+F@{S\+C\+I\+\_\+\+M\+A\+X\+\_\+\+T\+X\+B\+U\+F}!sci.\+h@{sci.\+h}}
\paragraph[{S\+C\+I\+\_\+\+M\+A\+X\+\_\+\+T\+X\+B\+U\+F}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+C\+I\+\_\+\+M\+A\+X\+\_\+\+T\+X\+B\+U\+F~128}\label{sci_8h_a3215a6d64ad06026d58b5f2a823def50_a3215a6d64ad06026d58b5f2a823def50}


送信バッファサイズ 



 sci.\+h の 31 行目に定義があります。

\index{sci.\+h@{sci.\+h}!S\+C\+I\+\_\+\+M\+A\+X\+\_\+\+R\+X\+B\+U\+F@{S\+C\+I\+\_\+\+M\+A\+X\+\_\+\+R\+X\+B\+U\+F}}
\index{S\+C\+I\+\_\+\+M\+A\+X\+\_\+\+R\+X\+B\+U\+F@{S\+C\+I\+\_\+\+M\+A\+X\+\_\+\+R\+X\+B\+U\+F}!sci.\+h@{sci.\+h}}
\paragraph[{S\+C\+I\+\_\+\+M\+A\+X\+\_\+\+R\+X\+B\+U\+F}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+C\+I\+\_\+\+M\+A\+X\+\_\+\+R\+X\+B\+U\+F~128}\label{sci_8h_a6f5d317e038f60b708d778579f143874_a6f5d317e038f60b708d778579f143874}


受信バッファサイズ 



 sci.\+h の 36 行目に定義があります。

\index{sci.\+h@{sci.\+h}!S\+C\+I\+\_\+\+E\+R\+R\+\_\+\+P\+A\+R\+I\+T\+Y@{S\+C\+I\+\_\+\+E\+R\+R\+\_\+\+P\+A\+R\+I\+T\+Y}}
\index{S\+C\+I\+\_\+\+E\+R\+R\+\_\+\+P\+A\+R\+I\+T\+Y@{S\+C\+I\+\_\+\+E\+R\+R\+\_\+\+P\+A\+R\+I\+T\+Y}!sci.\+h@{sci.\+h}}
\paragraph[{S\+C\+I\+\_\+\+E\+R\+R\+\_\+\+P\+A\+R\+I\+T\+Y}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+C\+I\+\_\+\+E\+R\+R\+\_\+\+P\+A\+R\+I\+T\+Y~(1\+U $<$$<$ 0)}\label{sci_8h_a3ebdf406c8df76754b38447eb28a4281_a3ebdf406c8df76754b38447eb28a4281}


パリティエラー識別子 



 sci.\+h の 41 行目に定義があります。

\index{sci.\+h@{sci.\+h}!S\+C\+I\+\_\+\+E\+R\+R\+\_\+\+F\+R\+A\+M\+I\+N\+G@{S\+C\+I\+\_\+\+E\+R\+R\+\_\+\+F\+R\+A\+M\+I\+N\+G}}
\index{S\+C\+I\+\_\+\+E\+R\+R\+\_\+\+F\+R\+A\+M\+I\+N\+G@{S\+C\+I\+\_\+\+E\+R\+R\+\_\+\+F\+R\+A\+M\+I\+N\+G}!sci.\+h@{sci.\+h}}
\paragraph[{S\+C\+I\+\_\+\+E\+R\+R\+\_\+\+F\+R\+A\+M\+I\+N\+G}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+C\+I\+\_\+\+E\+R\+R\+\_\+\+F\+R\+A\+M\+I\+N\+G~(1\+U $<$$<$ 1)}\label{sci_8h_a77d50c920e6676c04c79fde16f1fc975_a77d50c920e6676c04c79fde16f1fc975}


フレーミングエラー識別子 



 sci.\+h の 46 行目に定義があります。

\index{sci.\+h@{sci.\+h}!S\+C\+I\+\_\+\+E\+R\+R\+\_\+\+O\+V\+E\+R\+R\+U\+N@{S\+C\+I\+\_\+\+E\+R\+R\+\_\+\+O\+V\+E\+R\+R\+U\+N}}
\index{S\+C\+I\+\_\+\+E\+R\+R\+\_\+\+O\+V\+E\+R\+R\+U\+N@{S\+C\+I\+\_\+\+E\+R\+R\+\_\+\+O\+V\+E\+R\+R\+U\+N}!sci.\+h@{sci.\+h}}
\paragraph[{S\+C\+I\+\_\+\+E\+R\+R\+\_\+\+O\+V\+E\+R\+R\+U\+N}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+C\+I\+\_\+\+E\+R\+R\+\_\+\+O\+V\+E\+R\+R\+U\+N~(1\+U $<$$<$ 2)}\label{sci_8h_a6797a01bd01e4173548063aa903a953f_a6797a01bd01e4173548063aa903a953f}


オーバーランエラー識別子 



 sci.\+h の 51 行目に定義があります。



\subsubsection{関数詳解}
\index{sci.\+h@{sci.\+h}!S\+C\+I\+\_\+init@{S\+C\+I\+\_\+init}}
\index{S\+C\+I\+\_\+init@{S\+C\+I\+\_\+init}!sci.\+h@{sci.\+h}}
\paragraph[{S\+C\+I\+\_\+init()}]{\setlength{\rightskip}{0pt plus 5cm}void S\+C\+I\+\_\+init (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{sci_8h_a9f5d4690ca7dcd66e71193d76c18391b_a9f5d4690ca7dcd66e71193d76c18391b}


S\+C\+I初期化 

S\+C\+Iを使用可能に設定する。他\+A\+P\+I使用前に必ず実行しておく。 送受信は割り込みにより駆動される。~\newline
データ長8ビット、パリティなし、ストップビット1、フロー制御なし、 ボーレート19200bps \index{sci.\+h@{sci.\+h}!S\+C\+I\+\_\+communicate@{S\+C\+I\+\_\+communicate}}
\index{S\+C\+I\+\_\+communicate@{S\+C\+I\+\_\+communicate}!sci.\+h@{sci.\+h}}
\paragraph[{S\+C\+I\+\_\+communicate()}]{\setlength{\rightskip}{0pt plus 5cm}void S\+C\+I\+\_\+communicate (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{sci_8h_aed4704fa2e59ccf969ed22ba91e76b95_aed4704fa2e59ccf969ed22ba91e76b95}


送受信実行 

S\+C\+Iデバイスへ送受信処理を委託する。割り込みハンドラから呼ばれるのが前提。 \index{sci.\+h@{sci.\+h}!S\+C\+I\+\_\+puts@{S\+C\+I\+\_\+puts}}
\index{S\+C\+I\+\_\+puts@{S\+C\+I\+\_\+puts}!sci.\+h@{sci.\+h}}
\paragraph[{S\+C\+I\+\_\+puts(const \+\_\+\+S\+B\+Y\+T\+E $\ast$str)}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \+\_\+\+S\+I\+N\+T} S\+C\+I\+\_\+puts (
\begin{DoxyParamCaption}
\item[{const {\bf \+\_\+\+S\+B\+Y\+T\+E} $\ast$}]{str}
\end{DoxyParamCaption}
)}\label{sci_8h_af190c2cffd8521e60eeef84c3a81208e_af190c2cffd8521e60eeef84c3a81208e}


文字列送信 

文字列を送信する。文字列は\+N\+U\+L終端されていなければならない。 エラーが発生しない限り送信完了までブロックする。


\begin{DoxyParams}[1]{引数}
\mbox{\tt in}  & {\em str} & 送信文字列の先頭へのポインタ\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{戻り値}
{\em 正の値} & 送信完了文字数 \\
\hline
{\em 負の値} & 送信エラー \\
\hline
\end{DoxyRetVals}
\index{sci.\+h@{sci.\+h}!S\+C\+I\+\_\+write@{S\+C\+I\+\_\+write}}
\index{S\+C\+I\+\_\+write@{S\+C\+I\+\_\+write}!sci.\+h@{sci.\+h}}
\paragraph[{S\+C\+I\+\_\+write(const \+\_\+\+U\+B\+Y\+T\+E $\ast$data, \+\_\+\+U\+B\+Y\+T\+E size, \+\_\+\+B\+O\+O\+L sync, \+\_\+\+S\+I\+N\+T tmo\+\_\+ms)}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \+\_\+\+S\+I\+N\+T} S\+C\+I\+\_\+write (
\begin{DoxyParamCaption}
\item[{const {\bf \+\_\+\+U\+B\+Y\+T\+E} $\ast$}]{data, }
\item[{{\bf \+\_\+\+U\+B\+Y\+T\+E}}]{size, }
\item[{{\bf \+\_\+\+B\+O\+O\+L}}]{sync, }
\item[{{\bf \+\_\+\+S\+I\+N\+T}}]{tmo\+\_\+ms}
\end{DoxyParamCaption}
)}\label{sci_8h_afa2f96406c0057e6939906291282afa3_afa2f96406c0057e6939906291282afa3}


バイトストリーム送信 

汎用バイトデータを送信予約する。同期/非同期送信の両方に対応。 指定データは内部バッファへ格納され、次回の送信可能時に処理が実行される。


\begin{DoxyParams}[1]{引数}
\mbox{\tt in}  & {\em data} & 送信データの先頭へのポインタ \\
\hline
\mbox{\tt in}  & {\em size} & 送信サイズ \\
\hline
\mbox{\tt in}  & {\em sync} & \+\_\+\+T\+R\+U\+E\+: 同期型。size分送信できるか、タイムアウトするまで ブロックする。\+\_\+\+F\+A\+L\+S\+E\+: 非同期型。タイムアウトは無効 \\
\hline
\mbox{\tt in}  & {\em tmo\+\_\+ms} & 同期送信時のタイムアウト値。ミリセカンド。\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{戻り値}
{\em 正の値} & 送信完了サイズ \\
\hline
{\em 負の値} & 送信エラー \\
\hline
\end{DoxyRetVals}
\index{sci.\+h@{sci.\+h}!S\+C\+I\+\_\+read@{S\+C\+I\+\_\+read}}
\index{S\+C\+I\+\_\+read@{S\+C\+I\+\_\+read}!sci.\+h@{sci.\+h}}
\paragraph[{S\+C\+I\+\_\+read(\+\_\+\+U\+B\+Y\+T\+E $\ast$buf, \+\_\+\+U\+B\+Y\+T\+E size, \+\_\+\+B\+O\+O\+L sync, \+\_\+\+S\+I\+N\+T tmo\+\_\+ms)}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \+\_\+\+S\+I\+N\+T} S\+C\+I\+\_\+read (
\begin{DoxyParamCaption}
\item[{{\bf \+\_\+\+U\+B\+Y\+T\+E} $\ast$}]{buf, }
\item[{{\bf \+\_\+\+U\+B\+Y\+T\+E}}]{size, }
\item[{{\bf \+\_\+\+B\+O\+O\+L}}]{sync, }
\item[{{\bf \+\_\+\+S\+I\+N\+T}}]{tmo\+\_\+ms}
\end{DoxyParamCaption}
)}\label{sci_8h_a66e375aea15eee910b1fbf6002f09154_a66e375aea15eee910b1fbf6002f09154}


バイトストリーム受信 

内部バッファに溜まっているデータを取得する。同期/非同期受信の両方に対応。 内部バッファには非同期で随時受信データが溜まっていくため、定期的に この\+A\+P\+Iを実行しないとバッファが溢れデータロスが発生する。


\begin{DoxyParams}[1]{引数}
\mbox{\tt in}  & {\em buf} & 受信データを格納するバッファの先頭へのポインタ \\
\hline
\mbox{\tt in}  & {\em size} & 受信サイズ \\
\hline
\mbox{\tt in}  & {\em sync} & \+\_\+\+T\+R\+U\+E\+: 同期型。size分受信できるか、タイムアウトするまで ブロックする。\+\_\+\+F\+A\+L\+S\+E\+: 非同期型。タイムアウトは無効 \\
\hline
\mbox{\tt in}  & {\em tmo\+\_\+ms} & 同期受信時のタイムアウト値。ミリセカンド。\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{戻り値}
{\em 正の値} & 受信完了サイズ \\
\hline
{\em 負の値} & 受信エラー \\
\hline
\end{DoxyRetVals}
\index{sci.\+h@{sci.\+h}!S\+C\+I\+\_\+get\+Last\+Error@{S\+C\+I\+\_\+get\+Last\+Error}}
\index{S\+C\+I\+\_\+get\+Last\+Error@{S\+C\+I\+\_\+get\+Last\+Error}!sci.\+h@{sci.\+h}}
\paragraph[{S\+C\+I\+\_\+get\+Last\+Error()}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \+\_\+\+U\+B\+Y\+T\+E} S\+C\+I\+\_\+get\+Last\+Error (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{sci_8h_a31c5c3fad1871cd4940561cd57610d00_a31c5c3fad1871cd4940561cd57610d00}


エラー値取得 

最後に発生したエラー番号を取得する。

\begin{DoxyReturn}{戻り値}
エラー番号。\+S\+C\+I\+\_\+\+E\+R\+R\+\_\+$\ast$ で定義されているコード。 
\end{DoxyReturn}
